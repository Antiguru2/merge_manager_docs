# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üë• –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
Data Steward'—ã, –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å–∫–∞—é—Ç –µ–¥–∏–Ω–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–ª–∏—è–Ω–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
- –ó–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å, —É–∂–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã.
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ Django Admin –∏ –ø—Ä–∞–≤–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏.
- –ü—Ä–æ—Ñ–∏–ª—å —Å–ª–∏—è–Ω–∏—è –¥–ª—è –Ω—É–∂–Ω–æ–π –º–æ–¥–µ–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω.

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä—É—á–Ω–æ–≥–æ —Å–ª–∏—è–Ω–∏—è (—á–µ—Ä–µ–∑ Django shell)
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–º–∏–Ω–∫—É –∏ –Ω–∞–π–¥–∏—Ç–µ ID –ø—Ä–∏—ë–º–Ω–∏–∫–∞ –∏ –¥–æ–Ω–æ—Ä–∞.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Django shell:
   ```bash
   python manage.py shell
   ```
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```python
   from merge_manager.services import MergeService
   from main.models import City

   service = MergeService('city')
   target = City.objects.get(pk=1)
   donor = City.objects.get(pk=42)

   result = service.merge(target=target, donor=donor, user=request.user)
   print(result.status, result.changed_fields)
   ```
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç–∞—Ç—É—Å `completed` –∏ –≤ `result.soft_delete['applied']` —É–∫–∞–∑–∞–Ω–æ `True`.
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –≤ UI –ø—Ä–æ–µ–∫—Ç–∞.

## üëÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –†–∞–∑–¥–µ–ª ¬´Merge operations¬ª –≤ Django Admin –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å, —Å–≤–æ–¥–∫—É –ø–æ–ª–µ–π –∏ dry-run —Ñ–ª–∞–≥.
- –ü–æ–ª–µ `summary` —Å–æ–¥–µ—Ä–∂–∏—Ç JSON —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ (`fields`, `relations`, `soft_delete`).
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–∫–∞—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é, –∏—Å–ø–æ–ª—å–∑—É—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –∞—É–¥–∏—Ç–∞.

## ü§ñ Dry-run –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–º
–ü–µ—Ä–µ–¥ —Ä–µ–∞–ª—å–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```python
result = service.merge(target=target, donor=donor, dry_run=True)
print(result.changed_fields)
print(result.relations)
```
–≠—Ç–æ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ, –Ω–æ –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ.

## üìå –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ù–∞ —Ç–µ–∫—É—â–µ–º —ç—Ç–∞–ø–µ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –∑–∞–ø–∏—Å–µ–π –∏ –∑–∞–ø—É—Å–∫–∞ —Å–ª–∏—è–Ω–∏—è.
- –í—Å—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –æ–¥–Ω–æ–π –ø–∞—Ä–µ –∑–∞–ø–∏—Å–µ–π; –º–∞—Å—Å–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.
- –ú–æ–¥—É–ª—å –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –¥—É–±–ª–µ–π (–∏—â–∏—Ç–µ –∏—Ö –≤–Ω–µ—à–Ω–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏).

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞
- –û—à–∏–±–∫–∏ –ø—Ä–∏ —Å–ª–∏—è–Ω–∏–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∂—É—Ä–Ω–∞–ª `MergeOperation` (–ø–æ–ª–µ `message`).
- –ù–µ–ø—Ä–∏–º–µ–Ω—ë–Ω soft-delete ‚Üí —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –º–æ–¥–µ–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∑–∞–¥–∞–Ω–Ω–æ–µ –ø–æ–ª–µ –∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏.
- –°–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∑–Ω–∞—á–µ–Ω–∏–π ‚Üí –ø–æ–ø—Ä–æ—Å–∏—Ç–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–æ–±–∞–≤–∏—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∏–ª–∏ —Ñ–æ—Ä–º—É –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
